function modalDialogLink(n,t,i){var u;jQuery(".qtip.ui-tooltip-help").qtip("hide");var e=jQuery(n),f=Math.floor(Math.random()*1e7),o="SitkajQueryModalDialogUniqueID"+f,s="SitkajQueryModalDialogContentUniqueID"+f,r;return r=typeof i=="function"?i():i,u={type:"GET",url:n.href},r!=null&&(u={type:"POST",url:n.href,data:JSON.stringify(r),contentType:"application/json"}),SitkaAjax.ajax(u,function(n){createBootstrapDialogForm(e,o,s,t,n)}),!1}function findBootstrapDialogForm(n,t){var i;if(Sitka.Methods.isUndefinedNullOrEmpty(n)||(i=jQuery("#"+n,t)),Sitka.Methods.isUndefinedNullOrEmpty(i)&&(i=jQuery("form",t)),i.length>1)throw new Error("Found more than 1 form to post!  Cannot proceed.");return i}function createBootstrapDialogForm(n,t,i,r,u){var c=n.attr("data-dialog-title"),e=parseInt(n.attr("data-dialog-width")),h;e=e==0?"auto":e+"px";var o=n.attr("data-save-button-id"),l=n.attr("data-save-button-text"),a=n.attr("data-cancel-button-id"),v=n.attr("data-cancel-button-text"),s=n.attr("data-optional-dialog-form-id"),y=n.attr("data-skip-ajax").toLowerCase()==="true"?!0:!1,f=jQuery(getModalDialogFromHtmlTemplate(t,c,u,e,l,o,v,a));f.modal({backdrop:"static"});f.draggable({handle:".modal-header"});h=jQuery("#"+o);h.click(function(){var n=findBootstrapDialogForm(s,f);return n.valid()?(n.submit(),!0):!1});f.on("hide.bs.modal",function(){jQuery("*",f).qtip("hide")});f.on("hidden.bs.modal",function(){jQuery("#"+t).remove()});wireUpModalDialogForm(f,r,s,y)}function wireUpModalDialogForm(n,t,i,r){if(jQuery.validator.unobtrusive.parse(n),convertJQueryValidationErrorsToQtip(),Sitka.Methods.isUndefinedNullOrEmpty(r)&&(r=!1),Sitka.Methods.isUndefinedNullOrEmpty(t)||t(),jQuery(".sitkaDatePicker").datepicker(),!r){var u=findBootstrapDialogForm(i,n);u.ajaxForm({url:this.action,type:this.method,beforeSubmit:function(){jQuery(".progress-bar").html("Saving");jQuery(".progress").show()},success:function(r,u,f){SitkaAjax.handleLoginRedirect(r,u,f,function(){jQuery(".progress").hide();Sitka.Methods.isUndefinedNullOrEmpty(r)||Sitka.Methods.isUndefinedNullOrEmpty(r.Success)||!r.Success?(n.find(".modal-body").html(r),wireUpModalDialogForm(n,t,i)):(n.modal("hide"),Sitka.Methods.isUndefinedNullOrEmpty(r.RedirectUrl)?window.location.reload():window.location.href=r.RedirectUrl)})},error:function(t,i){jQuery(".progress").hide();n.modal("hide");SitkaAjax.errorHandler(t,i)}})}}function getModalDialogFromHtmlTemplate(n,t,i,r,u,f,e,o){var s=i.indexOf("requiredFieldIcon")!==-1,h=s?'<span><sup><span class="glyphicon glyphicon-flash" style="color: #800020; font-size: 8px; "><\/span><\/sup> Required Field<\/span>':"";return"<div class='modal firma-modal' id='"+n+"' tabindex='-1'><div class='modal-dialog firma-modal-dialog' style = 'width:90%; max-width: "+r+"'><div class='modal-content'><div class='modal-header'><button type='button' class='modal-close-button btn btn-xs btn-firma' data-dismiss='modal'><span>&times;<\/span><\/button><span class='modal-title'>"+t+"<\/span><\/div><div class='modal-body'>"+i+"<\/div><div class='modal-footer'>"+h+"<div class='modal-footer-buttons'><button type='button' id='"+f+"' class='btn btn-xs btn-firma'>"+u+"<\/button><button type='button' id='"+o+"' class='btn btn-xs btn-firma' data-dismiss='modal'>"+e+"<\/button><\/div><\/div><div class='progress' style='display:none'><div class='progress-bar progress-bar-info progress-bar-striped active' role='progressbar' style='width:100%'>Saving<\/div><\/div><\/div><\/div><\/div>"}